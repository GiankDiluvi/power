x = cv0,
y = 1.2*ymax0),
parse = TRUE) +          # add critical value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 12))
h0
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggsave("../img/1. significance.pdf")
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax0)) +
theme(axis.text = element_text(size = 14))
ggsave("../img/1. significance.pdf")
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax0)) +
theme(axis.text = element_text(size = 14))
ggsave("../img/1. significance.pdf")
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_text(aes(label = "alpha",
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax0)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=0.25) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF") + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
geom_text(aes(label = "Specificity",
x = cv0  - sd0/3,
y = dnorm(cv0  - sd0/4, mean = mu0, sd = sd0) + 0.15*ymax0),
parse = TRUE) +           # add specificity label
geom_text(aes(label = as.character(1 - t1e),
x = cv0 - sd0/4,
y = dnorm(cv0 - sd0/4, mean = mu0, sd = sd0) + 0.15*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add specificity value
geom_text(aes(label = as.character(round(cv0, 2)),
x = cv0,
y = 1.2*ymax0),
parse = TRUE) +          # add critical value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=0.25) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF") + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
geom_text(aes(label = "alpha",
x = cv0 + sd0/4,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0) + 0.1*ymax0),
parse = TRUE) +           # add alpha label
geom_text(aes(label = as.character(t1e),
x = cv0 + sd0/3,
y = dnorm(cv0 + sd0/4, mean = mu0, sd = sd0)  + 0.1*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add alpha value
geom_text(aes(label = "Specificity",
x = cv0  - sd0/3,
y = dnorm(cv0  - sd0/4, mean = mu0, sd = sd0) + 0.15*ymax0),
parse = TRUE) +           # add specificity label
geom_text(aes(label = as.character(1 - t1e),
x = cv0 - sd0/4,
y = dnorm(cv0 - sd0/4, mean = mu0, sd = sd0) + 0.15*ymax0 - 0.04*ymax0),
parse = TRUE) +           # add specificity value
geom_text(aes(label = as.character(round(cv0, 2)),
x = cv0,
y = 1.2*ymax0),
parse = TRUE) +          # add critical value
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax0)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=0.25) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF") + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax0)) +
theme(axis.text = element_text(size = 14))
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax1),
linetype="dashed",
size=0.25) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF") + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.75) + # fill up power +
labs(x = "",
y = "",
title = expression(H[1])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
# together
h0 <- ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF") + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error +
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
# H1 plot
h1 <- ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax1),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF") + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.75) + # fill up power +
labs(x = "",
y = "",
title = expression(H[1])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
h10 <- h0 / h1
h10
ggsave("../img/3. together", plot = h10)
ggsave("../img/3. togethe.pngr", plot = h10)
ggsave("../img/3. together.png", plot = h10)
?ggsave
,
ggsave("../img/3. together.png", plot = h10,
height = 2*7.64, width = 5.1)
ggsave("../img/3. together.png", plot = h10,
height = 2*5.1, width = 7.64)
ggsave("../img/3. together.png", plot = h10,
height = 2*5.1, width = 2*7.64)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF") + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF") + # fill up type I error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF") + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.75) +
labs(x = "",
y = "",
title = expression(H[0])) +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF",
alpha = 0.5) + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF",
alpha = 0.5) + # fill up type I error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF",
alpha = 0.5) + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.5,
alpha = 0.75) +
labs(x = "",
y = "") +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
# initial params
mu0 <- 0
mu1 <- 1
sigma2 <- 2
n <- 15
t1e <- 0.05
# create params
sd0 <- sqrt(sigma2 / n)
xmin0 <- mu0 - 3.5 * sd0
xmin1 <- mu1 - 3.5 * sd0
xmin <- min(xmin0, xmin1)
xmax0 <- mu0 + 3.5 * sd0
xmax1 <- mu1 + 3.5 * sd0
xmax <- max(xmax0, xmax1)
ymax0 <- dnorm(mu0, mean = mu0, sd = sd0)
ymax1 <- dnorm(mu1, mean = mu1, sd = sd0)
ymax <- max(ymax0, ymax1)
cv0 <- qnorm(1-t1e, mean = mu0, sd = sd0)
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF",
alpha = 0.5) + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF",
alpha = 0.5) + # fill up type I error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF",
alpha = 0.5) + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.5,
alpha = 0.75) +
labs(x = "",
y = "") +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF",
alpha = 0.5) + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF",
alpha = 0.5) + # fill up type I error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF",
alpha = 0.5) + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.5,
alpha = 0.75) +
labs(x = "",
y = "") +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
ggplot(tibble(x = c(xmin, xmax)), aes(x)) +
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0)) + #adds normal plot
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0)) + #adds normal plot
geom_segment(aes(x = cv0, y = 0,
xend = cv0, yend = 1.15*ymax0),
linetype="dashed",
size=1) + # adds line on critical value
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#55C667FF",
alpha = 0.5) + # fill up specificity
stat_function(fun = dnorm,
args = list(mean = mu0, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#D64B40FF",
alpha = 0.75) + # fill up type I error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(xmin, cv0),
geom = "area",
fill = "#FCA007FF",
alpha = 0.5) + # fill up  type II error
stat_function(fun = dnorm,
args = list(mean = mu1, sd = sd0),
xlim = c(cv0, xmax),
geom = "area",
fill = "#39558CFF",
alpha = 0.5,
alpha = 0.75) +
labs(x = "",
y = "") +
xlim(c(xmin, xmax)) +
theme(axis.text = element_text(size = 14))
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
source('~/Dropbox/Documents/UBC/2020/1. Term 2/2. STAT 550/power/dashboard/slides_plots.R', echo=TRUE)
